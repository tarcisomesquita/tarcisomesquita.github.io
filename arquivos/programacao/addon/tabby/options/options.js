(()=>{var t={467:t=>{t.exports={EXT_VERSION:"3.2.1",EXT_IS_MAJOR_RELEASE:!1}},532:(t,e,o)=>{"use strict";var n;(n="undefined"!=typeof process&&"[object process]"==={}.toString.call(process)||"undefined"!=typeof navigator&&"ReactNative"===navigator.product?o.g:self).Proxy||(n.Proxy=o(780)(),n.Proxy.revocable=n.Proxy.revocable)},780:t=>{t.exports=function(){let t,e=null;function o(t){return!!t&&("object"==typeof t||"function"==typeof t)}function n(t){if(null!==t&&!o(t))throw new TypeError("Object prototype may only be an Object or null: "+t)}const r=Object,i=Boolean(r.create)||!({__proto__:null}instanceof r),l=r.create||(i?function(t){return n(t),{__proto__:t}}:function(t){if(n(t),null===t)throw new SyntaxError("Native Object.create is required to create objects with null prototype");var e=function(){};return e.prototype=t,new e}),s=function(){return null},a=r.getPrototypeOf||([].__proto__===Array.prototype?function(t){const e=t.__proto__;return o(e)?e:null}:s);return t=function(c,u){if(void 0===(this&&this instanceof t?this.constructor:void 0))throw new TypeError("Constructor Proxy requires 'new'");if(!o(c)||!o(u))throw new TypeError("Cannot create proxy with a non-object as target or handler");let p=function(){};e=function(){c=null,p=function(t){throw new TypeError(`Cannot perform '${t}' on a proxy that has been revoked`)}},setTimeout((function(){e=null}),0);const f=u;u={get:null,set:null,apply:null,construct:null};for(let t in f){if(!(t in u))throw new TypeError(`Proxy polyfill does not support trap '${t}'`);u[t]=f[t]}"function"==typeof f&&(u.apply=f.apply.bind(f));const h=a(c);let d,y=!1,m=!1;"function"==typeof c?(d=function(){const t=this&&this.constructor===d,e=Array.prototype.slice.call(arguments);return p(t?"construct":"apply"),t&&u.construct?u.construct.call(this,c,e):!t&&u.apply?u.apply(c,this,e):t?(e.unshift(c),new(c.bind.apply(c,e))):c.apply(this,e)},y=!0):c instanceof Array?(d=[],m=!0):d=i||null!==h?l(h):{};const _=u.get?function(t){return p("get"),u.get(this,t,d)}:function(t){return p("get"),this[t]},w=u.set?function(t,e){p("set"),u.set(this,t,e,d)}:function(t,e){p("set"),this[t]=e},g=r.getOwnPropertyNames(c),v={};g.forEach((function(t){if((y||m)&&t in d)return;const e=r.getOwnPropertyDescriptor(c,t),o={enumerable:Boolean(e.enumerable),get:_.bind(c,t),set:w.bind(c,t)};r.defineProperty(d,t,o),v[t]=!0}));let b=!0;if(y||m){const t=r.setPrototypeOf||([].__proto__===Array.prototype?function(t,e){return n(e),t.__proto__=e,t}:s);h&&t(d,h)||(b=!1)}if(u.get||!b)for(let t in c)v[t]||r.defineProperty(d,t,{get:_.bind(c,t)});return r.seal(c),r.seal(d),d},t.revocable=function(o,n){return{proxy:new t(o,n),revoke:e}},t}},196:t=>{!function(){"use strict";t.exports={polyfill:function(){var t=window,e=document;if(!("scrollBehavior"in e.documentElement.style)||!0===t.__forceSmoothScrollPolyfill__){var o,n=t.HTMLElement||t.Element,r=468,i={scroll:t.scroll||t.scrollTo,scrollBy:t.scrollBy,elementScroll:n.prototype.scroll||a,scrollIntoView:n.prototype.scrollIntoView},l=t.performance&&t.performance.now?t.performance.now.bind(t.performance):Date.now,s=(o=t.navigator.userAgent,new RegExp(["MSIE ","Trident/","Edge/"].join("|")).test(o)?1:0);t.scroll=t.scrollTo=function(){void 0!==arguments[0]&&(!0!==c(arguments[0])?d.call(t,e.body,void 0!==arguments[0].left?~~arguments[0].left:t.scrollX||t.pageXOffset,void 0!==arguments[0].top?~~arguments[0].top:t.scrollY||t.pageYOffset):i.scroll.call(t,void 0!==arguments[0].left?arguments[0].left:"object"!=typeof arguments[0]?arguments[0]:t.scrollX||t.pageXOffset,void 0!==arguments[0].top?arguments[0].top:void 0!==arguments[1]?arguments[1]:t.scrollY||t.pageYOffset))},t.scrollBy=function(){void 0!==arguments[0]&&(c(arguments[0])?i.scrollBy.call(t,void 0!==arguments[0].left?arguments[0].left:"object"!=typeof arguments[0]?arguments[0]:0,void 0!==arguments[0].top?arguments[0].top:void 0!==arguments[1]?arguments[1]:0):d.call(t,e.body,~~arguments[0].left+(t.scrollX||t.pageXOffset),~~arguments[0].top+(t.scrollY||t.pageYOffset)))},n.prototype.scroll=n.prototype.scrollTo=function(){if(void 0!==arguments[0])if(!0!==c(arguments[0])){var t=arguments[0].left,e=arguments[0].top;d.call(this,this,void 0===t?this.scrollLeft:~~t,void 0===e?this.scrollTop:~~e)}else{if("number"==typeof arguments[0]&&void 0===arguments[1])throw new SyntaxError("Value could not be converted");i.elementScroll.call(this,void 0!==arguments[0].left?~~arguments[0].left:"object"!=typeof arguments[0]?~~arguments[0]:this.scrollLeft,void 0!==arguments[0].top?~~arguments[0].top:void 0!==arguments[1]?~~arguments[1]:this.scrollTop)}},n.prototype.scrollBy=function(){void 0!==arguments[0]&&(!0!==c(arguments[0])?this.scroll({left:~~arguments[0].left+this.scrollLeft,top:~~arguments[0].top+this.scrollTop,behavior:arguments[0].behavior}):i.elementScroll.call(this,void 0!==arguments[0].left?~~arguments[0].left+this.scrollLeft:~~arguments[0]+this.scrollLeft,void 0!==arguments[0].top?~~arguments[0].top+this.scrollTop:~~arguments[1]+this.scrollTop))},n.prototype.scrollIntoView=function(){if(!0!==c(arguments[0])){var o=function(t){for(;t!==e.body&&!1===f(t);)t=t.parentNode||t.host;return t}(this),n=o.getBoundingClientRect(),r=this.getBoundingClientRect();o!==e.body?(d.call(this,o,o.scrollLeft+r.left-n.left,o.scrollTop+r.top-n.top),"fixed"!==t.getComputedStyle(o).position&&t.scrollBy({left:n.left,top:n.top,behavior:"smooth"})):t.scrollBy({left:r.left,top:r.top,behavior:"smooth"})}else i.scrollIntoView.call(this,void 0===arguments[0]||arguments[0])}}function a(t,e){this.scrollLeft=t,this.scrollTop=e}function c(t){if(null===t||"object"!=typeof t||void 0===t.behavior||"auto"===t.behavior||"instant"===t.behavior)return!0;if("object"==typeof t&&"smooth"===t.behavior)return!1;throw new TypeError("behavior member of ScrollOptions "+t.behavior+" is not a valid value for enumeration ScrollBehavior.")}function u(t,e){return"Y"===e?t.clientHeight+s<t.scrollHeight:"X"===e?t.clientWidth+s<t.scrollWidth:void 0}function p(e,o){var n=t.getComputedStyle(e,null)["overflow"+o];return"auto"===n||"scroll"===n}function f(t){var e=u(t,"Y")&&p(t,"Y"),o=u(t,"X")&&p(t,"X");return e||o}function h(e){var o,n,i,s,a=(l()-e.startTime)/r;s=a=a>1?1:a,o=.5*(1-Math.cos(Math.PI*s)),n=e.startX+(e.x-e.startX)*o,i=e.startY+(e.y-e.startY)*o,e.method.call(e.scrollable,n,i),n===e.x&&i===e.y||t.requestAnimationFrame(h.bind(t,e))}function d(o,n,r){var s,c,u,p,f=l();o===e.body?(s=t,c=t.scrollX||t.pageXOffset,u=t.scrollY||t.pageYOffset,p=i.scroll):(s=o,c=o.scrollLeft,u=o.scrollTop,p=a),h({scrollable:s,method:p,startTime:f,startX:c,startY:u,x:n,y:r})}}}}()}},e={};function o(n){var r=e[n];if(void 0!==r)return r.exports;var i=e[n]={exports:{}};return t[n](i,i.exports,o),i.exports}o.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return o.d(e,{a:e}),e},o.d=(t,e)=>{for(var n in e)o.o(e,n)&&!o.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),o.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";var t=o(196),e=o.n(t);o(532);try{e().polyfill()}catch(t){console.log(t)}let n;function r(t,e){var o=document.createRange(),n=window.getSelection();o.setStart(t,e),o.collapse(!0),n.removeAllRanges(),n.addRange(o)}function i(t,e){return"*"===e&&console.error("store: option id '*' is reserved! will lead to unexpected behavior"),"__"+t+"_$"+e}function l(t,e){return e.startsWith("__"+t+"_$")}function s(t,e){return e.substring(4+t.length,e.length)}n=window,Array.from||(Array.from=function(){let t=Object.prototype.toString,e=function(e){return"function"==typeof e||"[object Function]"===t.call(e)},o=Math.pow(2,53)-1;return function(t){let n=Object(t);if(null==t)throw new TypeError("Array.from requires an array-like object - not null or undefined");let r,i=arguments.length>1?arguments[1]:void 0;if(void 0!==i){if(!e(i))throw new TypeError("Array.from: when provided, the second argument must be a function");arguments.length>2&&(r=arguments[2])}let l,s=function(t){let e=function(t){let e=Number(t);return isNaN(e)?0:0!==e&&isFinite(e)?(e>0?1:-1)*Math.floor(Math.abs(e)):e}(t);return Math.min(Math.max(e,0),o)}(n.length),a=e(this)?Object(new this(s)):new Array(s),c=0;for(;c<s;)l=n[c],a[c]=i?void 0===r?i(l,c):i.call(r,l,c):l,c+=1;return a.length=s,a}}()),n.t_delay=t=>new Promise((e=>setTimeout(e,t))),n.t_in=(t,e)=>t.hasOwnProperty(e),n.t_arrayBufferToBase64=function(t){let e="";return[].slice.call(new Uint8Array(t)).forEach((t=>e+=String.fromCharCode(t))),n.btoa(e)},n.t_getImage=function(t,e=!1){return new Promise(((o,n)=>{try{if(t.startsWith("chrome://"))o();else{let r=new XMLHttpRequest;r.onreadystatechange=function(){if(4==this.readyState)if(200==this.status){let t=r.getResponseHeader("Content-Type").trim();if(t.startsWith("image/")){let e="data:"+t+";charset=utf-8;base64,",n=t_arrayBufferToBase64(r.response);o(e+n)}else n('Image Request Failed: Content-Type is not an image! (Content-Type: "'+t+'")')}else n(this.status)},r.responseType="arraybuffer",r.open("GET",t,!0),e&&r.setRequestHeader("Cache-Control","no-store"),r.send()}}catch(t){n(t.message)}}))},n.t_ctrlCmdKey=function(){return navigator.platform.indexOf("Mac")>=0||"iPhone"===navigator.platform?"Meta":"Control"},n.t_getElementsBetween=function(t,e,o=t=>!0){if(!t.parentElement.isSameNode(e.parentElement))return;if(t.isSameNode(e))return[];let n=[],r=t=>t.nextElementSibling;t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_PRECEDING&&(r=t=>t.previousElementSibling);let i=r(t);for(;i&&!i.isSameNode(e);)o(i)&&n.push(i),i=r(i);return n},n.t_getInView=function(t,e,o){let n=e.getBoundingClientRect(),r=t.getBoundingClientRect();(n.y>r.y||n.y>r.y+r.height||r.y>=n.y+n.height||r.y+r.height>=n.y+n.height)&&t.scrollIntoView(o)},n.t_getCaretPosition=function(t){var e,o=0,n=t.ownerDocument||t.document,r=n.defaultView||n.parentWindow;if(void 0!==r.getSelection){if((e=r.getSelection()).rangeCount>0){var i=r.getSelection().getRangeAt(0),l=i.cloneRange();l.selectNodeContents(t),l.setEnd(i.endContainer,i.endOffset),o=l.toString().length}}else if((e=n.selection)&&"Control"!=e.type){var s=e.createRange(),a=n.body.createTextRange();a.moveToElementText(t),a.setEndPoint("EndToEnd",s),o=a.text.length}return o},n.t_setCaretPosition=function(t,e){let o=0,n=e;for(let i of t.childNodes)if(i.nodeType===Node.TEXT_NODE){if(o+=i.nodeValue.length,e<=o)return void r(i,n);n-=i.nodeValue.length}else if(i.nodeType===Node.ELEMENT_NODE){let t=i.innerText;if(o+=t.length,e<=o)return void t_setCaretPosition(i,n);n-=t.length}},n.t_stripHtml=function(t){return(new DOMParser).parseFromString(t,"text/html").body.textContent||""},n.t_byteLen=t=>new Blob([t]).size,n.t_chunkSubstr=function(t,e){const o=Math.ceil(t.length/e),n=new Array(o);for(let r=0,i=0;r<o;++r,i+=e)n[r]=t.substr(i,e);return n},n.t_chunkBytes=function(t,e){let o=Math.ceil(t_byteLen(t)/e),n=new Array(o),r=0;n[r]="";for(const o of t){let t=n[r]+o;t_byteLen(t)>e?(r++,r>=n.length&&n.push(""),n[r]=o):n[r]=t}return n},n.t_browserDetection=function(){return browser.runtime.getURL("/").startsWith("moz")?"moz":"chromium"},n.t_getKeyboardFocusableElements=(t=document)=>[...t.querySelectorAll('a[href], button, input, textarea, select, details,[tabindex]:not([tabindex="-1"])')].filter((t=>!t.hasAttribute("disabled")&&!t.getAttribute("aria-hidden"))),n.t_resetAnimation=function(t){t.style.animation="none",t.offsetHeight,t.style.animation=null},n.t_tryParseJSONObject=function(t){try{var e=JSON.parse(t);if(e&&"object"==typeof e)return e}catch(t){}return!1},n.t_sanitizeXMLTags=function(t){return t.replace(/<\/?([a-zA-Z0-9]+)>/g,(t=>t.replace("<","&lt;").replace(">","&gt;")))},n.t_errorToString=t=>`${t.toString()}\n${t.stack||"No stack trace available."}`;const a=t=>i(t,"___DELONSTART");class c extends Error{}class u{constructor(t,e="conf",o=!1){this.type=t,this.name=e,this.tmp=o,this.__fulfillers={},this.__modifierPromises={}}async modify(t,e,o=!0){let n=this.__modifierPromises[t];return this.__modifierPromises[t]=new Promise((async(r,l)=>{try{n&&await n;let l=o?await this.getOne(t):void 0,s=e(l);s instanceof Promise&&(s=await s),void 0!==s&&await this.__set(i(this.name,t),s),r()}catch(e){console.error(`storage modification for property "${t}" failed with the following error:`),console.error(e),r()}})),this.__modifierPromises[t]}async modifyAll(t,e,...o){let n=o.map((t=>this.__modifierPromises[t])),r=new Promise((async(r,i)=>{try{for(let t of n)void 0!==t&&await t;let i=e?await this.get(...o):void 0,l=t(i);l instanceof Promise&&(l=await l),void 0!==l&&await this.__setAll(l),r()}catch(t){console.error(`storage modification for properties "${o}" failed with the following error:`),console.error(t),r()}}));for(let t of o)this.__modifierPromises[t]=r;return r}special(t){return i(this.name,t)}isSpecial(t){return l(this.name,t)}normal(t){return s(this.name,t)}__delOnStart(){return this.modify(a(this.name),(async()=>{let t=await this.__getOne(a(this.name));if(t)return console.log("[store] delOnStart exists: "),console.log(t),this.modifyAll((()=>(console.log("[store] deleting"),this.__unset(...t))),!1,...t).then((()=>this.__set(a(this.name),[])));this.__set(a(this.name),[])}),!1)}__chunkNumber(t,e,o="_part"){return parseInt(e.substring(t.length+o.length))}async storeLarge(t,e,o=8092){const n=t_chunkBytes(e,o),r=await this.getKeys();let i=[];for(let e of r)e.startsWith(t)&&this.__chunkNumber(t,e)>=n.length&&i.push(e);let l={};for(let[e,o]of n.entries())l[t+"_part"+e]=o;await this.unset(...i);try{await this.setAll(l,!0)}catch(t){throw await this.unset(...Object.keys(l)),new c("storeLarge failed! error: "+t)}}async retrieveLarge(t){const e=await this.getKeys();let o=[],n=0;for(let r of e)if(r.startsWith(t)){o.push(r);let e=this.__chunkNumber(t,r);e>n&&(n=e)}let r=await this.get(...o),i="";for(let e=0;e<=n;e++)i+=r[t+"_part"+e];return i}async hasOne(t){return t=i(this.name,t),(await browser.storage[this.type].get(t)).hasOwnProperty(t)}async has(...t){let e={};for(let o of t)e[o]=await this.hasOne(o);return e}unset(...t){return this.modifyAll((async()=>{let e=await this.__getOne(a(this.name));for(let o of t){let t=e.indexOf(o);-1!==t&&e.splice(t,1)}await this.__set(a(this.name),e),await this.__unset(...t)}),!1,a(this.name),...t)}async __unset(...t){return browser.storage[this.type].remove(t.map((t=>i(this.name,t))))}set(t,e){return this.modifyAll((async()=>{let o=await this.__getOne(a(this.name));o=o||[],o.includes(t)||o.push(t),await this.__set(a(this.name),o),await this.__set(i(this.name,t),e)}),!1,a(this.name),t)}async __set(t,e){let o={};return o[t]=e,browser.storage[this.type].set(o)}async setAll(t,e=!1){for(let o in t)t.hasOwnProperty(o)&&(!e&&await this.hasOne(o)||await this.set(o,t[o]))}async __setAll(t,e=!1){for(let o in t)t.hasOwnProperty(o)&&(!e&&await this.hasOne(o)||await this.__set(i(this.name,o),t[o]))}async getOne(t){return this.__getOne(i(this.name,t))}async __getOne(t){return(await browser.storage[this.type].get(t))[t]}async getKeys(){return this.__getOne(a(this.name))}async get(...t){let e={};for(let o of t)e[o]=await this.getOne(o);return e}__manual_fulfill(t,e,o){return Promise.resolve(o(e,t))}async __fulfill(t,e){return this.__manual_fulfill(t,await this.getOne(t),e)}async fulfillOnce(t,e,o=void 0){return void 0!==o&&(await this.hasOne(t)||await this.set(t,o)),this.__fulfill(t,e)}addFulfiller(t,e){this.__fulfillers.hasOwnProperty(t)||(this.__fulfillers[t]=[]),this.__fulfillers[t].push(e)}removeFulfiller(t,e){if(this.__fulfillers.hasOwnProperty(t)){let o=this.__fulfillers[t].indexOf(e);-1!==o&&this.__fulfillers[t].splice(o,1)}}async fulfill(t,e,o=void 0){return void 0!==o&&(await this.hasOne(t)||await this.set(t,o)),this.addFulfiller(t,e),this.fulfillOnce(t,e,void 0)}async __onChange(t){console.log(Object.keys(t));for(let e in t)if(t.hasOwnProperty(e)&&l(this.name,e)){let o=s(this.name,e);this.__fulfillers.hasOwnProperty(o)&&this.__fulfillers[o].forEach((n=>this.__manual_fulfill(o,t[e].newValue,n))),this.__fulfillers.hasOwnProperty("*")&&this.__fulfillers["*"].forEach((n=>this.__manual_fulfill(o,t[e].newValue,n)))}}}const p=new u("local"),f=new u("sync"),h=new u("local","temp",!0),d=new u("sync","temp",!0);browser.storage.onChanged.addListener((async(t,e)=>{switch(e){case"local":await p.__onChange(t),await h.__onChange(t);break;case"sync":await f.__onChange(t),await d.__onChange(t)}}));var y=o(467);let m={"option:popup-size":[760,465],"option:popup-scale":.9,"option:show-tab-info":3,"option:hide-popup-after-tab-selection":!0,"option:search-in-urls":!0,"option:popup-custom-theme":"","option:popup-theme":"classic","option:dont-clear-search":!0,"option:show-whats-new-on":"major-update","option:separate-save":!1};function _(t){return m[t]}document.querySelector("#version").innerText=`Tabby ${y.EXT_VERSION}`,p.fulfill("option:popup-size",(t=>{let e=document.querySelector("#option-popup-width"),o=document.querySelector("#option-popup-height");e.oninput=t=>{p.modify("option:popup-size",(t=>(t[0]=parseInt(e.value),t)),!0)},o.oninput=t=>{p.modify("option:popup-size",(t=>(t[1]=parseInt(o.value),t)),!0)},e.value=t[0],o.value=t[1]}),_("option:popup-size")),p.fulfill("option:popup-scale",(t=>{let e=document.querySelector("#option-popup-scale");e.oninput=t=>{p.modify("option:popup-scale",(t=>parseFloat(e.value)),!0)},e.value=t}),_("option:popup-scale")),p.fulfill("option:show-tab-info",(t=>{let e=document.querySelector("#option-show-tab-details"),o=document.querySelector("#option-show-tab-preview");e.oninput=t=>{p.modify("option:show-tab-info",(t=>e.checked?2:1),!0)},o.oninput=t=>{p.modify("option:show-tab-info",(t=>o.checked?3:2),!0)},1===t?(e.checked=!1,o.checked=!1):2===t?(e.checked=!0,o.checked=!1):3===t&&(e.checked=!0,o.checked=!0)}),_("option:show-tab-info")),p.fulfill("option:hide-popup-after-tab-selection",(t=>{let e=document.querySelector("#option-hide-popup-after-tab-selection");e.oninput=t=>{p.modify("option:hide-popup-after-tab-selection",(t=>e.checked),!0)},e.checked=t}),_("option:hide-popup-after-tab-selection")),p.fulfill("option:popup-theme",(t=>{let e=document.querySelectorAll(".popup-theme");for(let t of e)t.oninput=e=>{p.modify("option:popup-theme",(()=>t.getAttribute("data-theme-id")),!1)};let o=document.querySelector(`.popup-theme[data-theme-id="${t}"]`);o&&(o.checked=!0)}),_("option:popup-theme")),p.fulfill("option:popup-custom-theme",(t=>{let e=document.querySelector("#popup-custom-theme");e.oninput=t=>{p.modify("option:popup-custom-theme",(t=>e.value),!0)},e.value=t}),_("option:popup-custom-theme")),p.fulfill("option:dont-clear-search",(t=>{let e=document.querySelector("#option-dont-clear-search");e.oninput=t=>{p.modify("option:dont-clear-search",(t=>e.checked),!0)},e.checked=t}),_("option:dont-clear-search")),p.fulfill("option:show-whats-new-on",(t=>{let e=document.querySelector("#option-show-whats-new-on");e.onclick=t=>{p.modify("option:show-whats-new-on",(t=>{switch(t){case"update":return"major-update";case"major-update":return"never";case"never":return"update"}}),!0)},e.setAttribute("data-state",t)}),_("option:show-whats-new-on")),p.fulfill("option:separate-save",(t=>{let e=document.querySelector("#option-separate-save");e.oninput=t=>{p.modify("option:separate-save",(t=>e.checked),!0)},e.checked=t}),_("option:separate-save"))})()})();